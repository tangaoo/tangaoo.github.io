---
layout: post
title:  "翼辉笔试题"
categories: tmp
tags:  tmp
author: tangoo
mathjax: true
---


* content
{:toc}

计算题目还是在有语法高亮的环境里看的习惯一点。






{% raw %}

## C语言：(每题3分，共30分)
### 1.在32位机上，请写出sizeof(a)的值。
* a)int a;        `4` 
* b)char a;       `1`
* c)int *a;	      `4` 
* d)char *a;      `4`
* e)int *a[10];   `40`
* f)char *a[10];  `40`
* g)float a;      `4`
* h)double a;     `8`
* i)struct { int m; char n} a;    `5` 或者 `8`
* j)struct { int m; char n} *a;   `4` 
* k)union { int m; char n} a;     `4` 
* l)void (*a)(void);              `4` 

### 2.写出求两个数中最大值的宏MAX(a, b)。                                   

```cpp
/// max
#define MAX(a, b)                    ((a) > (b) ? (a) : (b))
```
### 3.union { int a; char b} c; c.a = 0x12345678;写出小端机器上c.b的值。             

`0x78`

### 4.下面程序：

```cpp
int a[5][5], i;
int *p = (int *)(a + 1);
for (i = 0; i < 20; i++) {
    *p++ = i;
}
```

执行上面程序后，a[3][2]的值是？        

`12`

### 5.写出volatile的作用。                                                         

* 阻止编译器优化；
* 相当于禁止 cache；
* 在 Linux 里反对使用 volatile 关键字。见内核文档[volatile-considered-harmful](https://www.kernel.org/doc/Documentation/process/volatile-considered-harmful.rst)
                                                                                
### 6.写出static有哪些作用。                                                       

* 对于变量:
  * 限定作用域；
  * 变量会存放在 .data 段，而不是栈空间。

* 对于函数:
  * 主要限定作用域；
                                                                                
### 7.写出头文件的作用和如何防止头文件的内容被重复定义？                          

```cpp
#ifndef _HEADER_H_
#define _HEADER_H_

#endif
```
### 8.写出C++源代码调用C函数void func(void)的函数声明。                           

```cpp
extern "C" void func(void);
```

### 9.UART的配置寄存器（32位）地址为0x10000000，其格式如下：

```
+------------------------------------+-------------------------------+---------+
|31                               11 |	10                         2 |	1    0 |
+------------------------------------+-------------------------------+---------+
|      A                             |                 B             |       C |
+------------------------------------+-------------------------------+---------+
```

写出将B域置为0x1F的代码片断：                                             

```cpp
unsigned int *UART = (unsigned int*)0x10000000;

// 实际不能空格
*UART = ((*UART) & (0b1111 1111 1111 1111 1111 1000 0000 0011)) & (0b1111 1111 1111 1111 1111 1000 0111 1111);
```
                                                                                 
### 10.int a=50; a>>=2;写出a的值。          

`12`

## 数据结构：（共30分）

### 1.写出先入先出队列的结构体Queue定义，并实现以下函数：

Queue *create(int size)：创建一个能放size个int类型的队列，返回队列的指针。（5分）
int put(Queue *queue, int value)：将value入队，返回0表示成功，-1表示出错。（5分）
int get(Queue *queue, int *pvalue)：将数据出队并存入pvalue，返回0表示成功，-1表示出错。（5分）

* 参见我在 github 上库 ttlib 中的[queue_entry.c](https://github.com/tangaoo/ttlib/blob/main/src/ttlib/container/queue_entry.h)。

### 2.有如下一数据结构

typedef struct node_t {
data_t           data;
struct node_t    *next;
struct node_t    *prior;
} linknode_t; 
请写出删除一个节点p的步骤: （5分）
请写出在n节点后面增加一个节点s的操作步骤：（5分）

* 参见我在 github 上库 ttlib 中的[single_list_entry.c](https://github.com/tangaoo/ttlib/blob/main/src/ttlib/container/single_list_entry.c)。

### 3.有一个C语言用来删除单链表的头元素的函数，请找出其中的问题，并加以纠正。（5分）

```cpp
void RemovHead(node *head)
{
    free(head);
    head = head->next;
}
```

改正为：

```cpp
void RemovHead(node *head)
{
    temp = head;
    head = head->next;
    free(temp);
}
```


## 编程题：（共30分）

### 1.请编写函数int sum(int n)，求1+2+3+…+n的值。（10分）

```cpp
int sum(int n)
{
    int sum = 0;

    // check n
    if (n <= 0) return -1;

    for(i = 1; i <=n; i++)
        sum += i;

    return sum;
}
```

### 2.请编写函数char *octalString(int value)，将int型参数转换为8进制字符串。(15分)

```cpp
// 注意该函数不可重入
char *octalString(int value)
{
    static buff[128];

    sprintf(buff, "%o", value);

    return buff;
}
```

### 3.请编写函数void swap(int *a, int *b)，使a，b指向的值交换。（要求不能使用额外的变量）（5分）

```cpp
void swap(int *a, int *b)
{
    *a = *a ^ *b;
    *b = *a ^ *b;
    *a = *a ^ *b;
}
```

## 简答题：（10分）
### 1、请你罗列出你熟悉的RTOS，并试着描述一个你最了解的RTOS相关部分，最好是和技术原理，实现机制有关。如果描述特点，也请一并描述这一特点的技术原理。

* 直接看 [rt-thread源码](https://github.com/RT-Thread/rt-thread)吧。

{% endraw %}